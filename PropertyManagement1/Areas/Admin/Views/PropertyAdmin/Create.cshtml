@model PropertyManagement1.Models.Property
@using PropertyManagement1.Models;

@{
    ViewBag.Title = "Create";
    Layout = "~/Areas/Admin/Views/Shared/_AdminLayout.cshtml";
}

<h2 style="text-align:center" >Tạo Bất Động Sản Mới</h2>

@Html.ValidationSummary(true)
@using (Html.BeginForm("Create", "PropertyAdmin", FormMethod.Post, new { enctype = "multipart/form-data" }))
{
    @Html.AntiForgeryToken()

<div class="form-horizontal">
    
    <hr />
    @Html.ValidationSummary(true, "", new { @class = "text-danger" })

    <div class="form-group">
        @Html.LabelFor(model => model.Property_Name,"Tên Bất Động Sản", htmlAttributes: new { @class = "control-label col-md-2" })
        <div class="col-md-10">
            
            @Html.EditorFor(model => model.Property_Name, new { htmlAttributes = new { @class = "form-control" } })
            @Html.ValidationMessageFor(model => model.Property_Name, "", new { @class = "text-danger" })
        </div>
    </div>

    <div class="form-group">
        @Html.LabelFor(model => model.Property_Type_ID, "Loại Bất Động Sản", htmlAttributes: new { @class = "control-label col-md-2" })
        <div class="col-md-10">
            @Html.DropDownList("Property_Type_ID", null, htmlAttributes: new { @class = "form-control" })
            @Html.ValidationMessageFor(model => model.Property_Type_ID, "", new { @class = "text-danger" })
        </div>
    </div>

    <div class="form-group">
        @Html.LabelFor(model => model.Description,"Mô Tả Sản Phẩm", htmlAttributes: new { @class = "control-label col-md-2" })
        <div class="col-md-10">
            @Html.EditorFor(model => model.Description, new { htmlAttributes = new { @class = "form-control" } })
            @Html.ValidationMessageFor(model => model.Description, "", new { @class = "text-danger" })
        </div>
    </div>

    <div class="form-group">
        <label class="control-label col-md-2">
            Thành Phố
        </label>
        <div class="col-md-10">
            @Html.DropDownList("CityList", null, "--Select City--", htmlAttributes: new { @class = "form-control" })
        </div>
    </div>

    <div class="form-group">
        <label class="control-label col-md-2">
            Quận
        </label>
        <div class="col-md-10">
            @Html.DropDownList("District_ID", null, htmlAttributes: new { @class = "form-control" })
            @Html.ValidationMessageFor(model => model.District_ID, "", new { @class = "text-danger" })
        </div>
    </div>

    <div class="form-group">
        @Html.LabelFor(model => model.Address,"Địa Chỉ", htmlAttributes: new { @class = "control-label col-md-2" })
        <div class="col-md-10">
            @Html.EditorFor(model => model.Address, new { htmlAttributes = new { @class = "form-control" } })
            @Html.ValidationMessageFor(model => model.Address, "", new { @class = "text-danger" })
        </div>
    </div>

    <div class="form-group">
        @Html.LabelFor(model => model.Area, "Diện Tích",htmlAttributes: new { @class = "control-label col-md-2" })
        <div class="col-md-10">
            @Html.EditorFor(model => model.Area, new { htmlAttributes = new { @class = "form-control" } })
            @Html.ValidationMessageFor(model => model.Area, "", new { @class = "text-danger" })
        </div>
    </div>

    <div class="form-group">
        @Html.LabelFor(model => model.Bed_Room,"Phòng Ngủ", htmlAttributes: new { @class = "control-label col-md-2" })
        <div class="col-md-10">
            @Html.EditorFor(model => model.Bed_Room, new { htmlAttributes = new { @class = "form-control" } })
            @Html.ValidationMessageFor(model => model.Bed_Room, "", new { @class = "text-danger" })
        </div>
    </div>

    <div class="form-group">
        @Html.LabelFor(model => model.Bath_Room," Nhà Tắm" ,htmlAttributes: new { @class = "control-label col-md-2" })
        <div class="col-md-10">
            @Html.EditorFor(model => model.Bath_Room, new { htmlAttributes = new { @class = "form-control" } })
            @Html.ValidationMessageFor(model => model.Bath_Room, "", new { @class = "text-danger" })
        </div>
    </div>

    <div class="form-group">
        @Html.LabelFor(model => model.Price," Giá "  , htmlAttributes: new { @class = "control-label col-md-2" })
        <div class="col-md-10">
            @{
                string displayValue;
                if (Model == null)
                {
                    displayValue = null;
                }
                else
                {
                    var formatString = (ViewData.ModelMetadata).DisplayFormatString;
                    displayValue = formatString == null ? Model.Price.ToString() : string.Format(formatString, Model.Price);
                }

            }
            @Html.TextBoxFor(c => c.Price, new { type = "text", Value = displayValue, @class = "form-control" })
            @Html.ValidationMessageFor(model => model.Price, "", new { @class = "text-danger" })
        </div>
    </div>

    <div class="form-group">
        @Html.LabelFor(model => model.Installment_Rate,"Trả Góp" , htmlAttributes: new { @class = "control-label col-md-2" })
        <div class="col-md-10">
            @Html.EditorFor(model => model.Installment_Rate, new { htmlAttributes = new { @class = "form-control" } })
            @Html.ValidationMessageFor(model => model.Installment_Rate, "", new { @class = "text-danger" })
        </div>
    </div>

    <div class="form-group">
        @Html.LabelFor(model => model.Avatar,"Ảnh Đại Diện" ,htmlAttributes: new { @class = "control-label col-md-2" })
        <div class="col-md-10">
            <input name="file" type="file" id="file" />
            @Html.HiddenFor(m => m.Avatar)

        </div>
    </div>

    <div class="form-group">
        @Html.LabelFor(model => model.Album," Album" ,htmlAttributes: new { @class = "control-label col-md-2" })
        <div class="col-md-10">
            <input name="files" type="file" multiple />
            @Html.ValidationMessageFor(model => model.Album, "", new { @class = "text-danger" })
        </div>
    </div>

    <div class="form-group">
        @Html.LabelFor(model => model.Property_Status_ID, "Trạng Thái Bất Động Sản", htmlAttributes: new { @class = "control-label col-md-2" })
        <div class="col-md-10">
            @Html.DropDownList("Property_Status_ID", null, htmlAttributes: new { @class = "form-control" })
            @Html.ValidationMessageFor(model => model.Property_Status_ID, "", new { @class = "text-danger" })
        </div>
    </div>

    <div class="form-group">
        <div class="col-md-offset-2 col-md-10">
            <input type="submit" value="Tạo Mới" class="btn btn-default" /> 
        </div>
    </div>
</div>
}

<div>
    @Html.ActionLink("Back to List", "Index")
</div>

@section Scripts {
    @Scripts.Render("~/bundles/jqueryval")

    <script>
        $(document).ready(function () {

            var districtUrl = "/Admin/PropertyAdmin/GetDistrictByCityId/";
            $("#ddlCity").on('change', function () {
                var id = $(this).val();
                _getDistrict(id, "ddlDistrict");
            });
            function _getDistrict(id, targetId) {   
                $.get(districtUrl + id, function (data) {
                    if (data != null && data != undefined && data.length) {
                        var html = '';
                        html += '<option value="">--Select district--</option>';
                        $.each(data, function (key, item) {
                            html += '<option value=' + item.ID + '>' + item.District_Name + '</option>';
                        });
                        $("#" + targetId).html(html);
                    } else {
                        var html = '';
                        html += '<option value="">--No district--</option>';
                        $("#" + targetId).html(html);
                    }
                });
            }
        });
    </script>
}
